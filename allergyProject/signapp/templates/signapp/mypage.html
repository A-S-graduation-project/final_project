{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="signup-form">
  <h1>회원 프로필</h1>
  {% if form.errors %}
  <div class="alert alert-danger">
    <ul>
      {% for field, errors in form.errors.items %}
      {% for error in errors %}
      <li>{{ field|title }}: {{ error }}</li>
      {% endfor %}
      {% endfor %}
    </ul>
  </div>
{% endif %}
  <form method="post">
    {% csrf_token %}
    <label for="username">ID</label>
    <input type="text" id="username" value="{{ user_profile.username }}" readonly>
    <label for="email">이메일</label>
    <input type="email" id="email" value="{{ user_profile.email }}">
    <label for="phone">전화번호</label>
    <input type="tel" id="phone" name="phone" value="{{ user_profile.phone }}">
    <label for="birthdate">출생일</label>
    <input type="date" id="birthdate" name="birthdate" value="{{ user_profile.birthdate|date:'Y-m-d' }}">
    <label>성별</label>
    <div class="gender-label-container">
      <label for="male" class="gender-label {% if user_profile.gender %}selected{% endif %}">남자</label>
      <input type="radio" id="male" name="gender" value="1" {% if user_profile.gender %}checked{% endif %}>
      <label for="female" class="gender-label {% if not user_profile.gender %}selected{% endif %}">여자</label>
      <input type="radio" id="female" name="gender" value="0" {% if not user_profile.gender %}checked{% endif %}>
    </div>


    <label for="password">새 비밀번호</label>
    <input type="password" id="password" name="password">
    <label for="password-confirm">비밀번호 확인</label>
    <input type="password" id="password-confirm" name="password-confirm">
    
    <input type="submit" value="프로필 업데이트">
  </form>
  <form action = "{% url 'signapp:delete' %}" method="POST"  id="delete-form">
    {% csrf_token %}
    <input type = "submit" value = "회원탈퇴" onclick="return confirmDelete()">
  </form>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const genderLabels = document.querySelectorAll('.gender-label');

    genderLabels.forEach(label => {
      label.addEventListener('click', function() {
        genderLabels.forEach(label => label.classList.remove('selected'));
        this.classList.add('selected');

        const genderRadio = document.getElementById(this.getAttribute('for'));
        genderRadio.checked = true;
      });
    });
  });
  function confirmDelete() {
    if (confirm("정말로 회원 탈퇴하시겠습니까? 모든 계정의 정보가 삭제됩니다.")) {
        // 사용자가 확인을 눌렀을 때만 폼을 제출
        document.getElementById('delete-form').submit();
    } else {
        // 사용자가 취소를 눌렀을 때
        return false; // 폼 제출 취소
    }
}
</script>
{% endblock %}
